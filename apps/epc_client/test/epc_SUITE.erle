-module(epc_SUITE).
-author("adriansan_93@yahoo.com").

% Test server callbacks
-export([suite/0,
         all/0,
        init_per_suite/1,
        end_per_suite/1,
        init_per_testcase/2,
        end_per_testcase/2,
        stop_proc/1]).

% Test case exports

-export([app/0]).

-include_lib("common_test/include/ct.hrl").
-include_lib("stdlib/include/assert.hrl").

suite()->
    [{timetrap,{seconds,10}}].

init_per_suite(Config)->
    case erlang:is_alive() of
        false-> 
          %% verify epmd running (otherwise next call fails)
           (erl_epmd:names()=:={error,address}) andalso
           begin 
           ([]=os:cmd("epmd -daemon")),
           timer:sleep(500) %lets daemon start
           end,
           {ok,_}=erl_epmd:names(),
           NodeName=list_to_atom(lists:concat([atom_to_list(?MODULE),"_",os:getpid()])),
           [{distribution,Pid}|Config];
        true ->
          Config
    end.

end_per_suite(Config)->
    is_pid(proplists:get_value(distribution,Config)) andalso net_kernel:stop().

init_per_testcase(app,Config)->Config;
init_per_testcase(Testcase,Config)->
    Config.

end_per_testcase(app,Config)->
     Config

